# 第8章 推理提示

## 8.2 基础思维链

### 8.2.1 零样本提示

```
// 原始问题
一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？

// 错误答案
一共有29只动物，15只大熊猫和14只金丝猴。
```

### 8.2.2 少样本提示

例子1：利用少样本提示翻译文本。

输入：

```
// 少样本示例
问: 熊猫的主要食物是竹子，它们每天要吃很多竹子。
答: The main food of pandas is bamboo, and they have to eat a lot of bamboo every day

问: 一只成年大熊猫的体重为90~130千克，而一只初生的大熊猫幼仔平均体重约为100克，是妈妈体重的千分之一。
答: An adult giant panda weighs between 90-130kg, while a newborn panda cub weighs around 100g on average, which is 0.1% of its mother’s weight.

// 正式提问
问: 大熊猫是地球上生存了至少800万年的动物，被誉为“活化石”和“中国国宝”，世界自然基金会的形象大使。
答: 
```

输出：

```
The giant panda is an animal that has survived on Earth for at least 8 million years, and is known as a "living fossil" and a "Chinese national treasure". It is also the image ambassador of the World Wildlife Fund
```

例子2：利用少样本提示进行数学推理。

输入：

```
问: 一个人每天吃两个苹果，一个月（按30天计算）能吃多少个苹果？
答: 60个

问: 一个人有4种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，西瓜是其中最大的水果，那么他吃完所有水果的顺序有多少种？
答: 24种

问: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？
```

输出：

```
答: 一共有29只动物，15只大熊猫和14只金丝猴。
```

### 8.2.3 少样本思维链提示

 输入：

```
//两个小样本思维链示例
问：一个人每天吃两个苹果，不管是红色的还是绿色的，一个月能吃多少个苹果？
答：首先，我们知道一个人每天吃两个苹果。然后，我们需要知道一个月有多少天。通常情况下，一个月可能有28天、30天或31天。所以，如果一个月有30天的话，那么这个人就会吃到60个苹果（2苹果/天 × 30天/月 = 60苹果/月）。如果一个月有31天的话，那么这个人就会吃到62个苹果（2苹果/天 × 31天/月 = 62苹果/月）。而如果是二月份（非闰年），那么这个人就会吃到56个苹果（2苹果/天 x 28天/月 = 56苹果/月

问：一个人有四种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，西瓜是其中最大的水果，那么他吃完所有水果的顺序有多少种？
答：首先，我们知道这个人有四种水果：苹果、香蕉、橘子和西瓜。他每次只能吃一种水果，然后换一种水果。那么，他吃完所有水果的顺序有多少种呢？这其实是一个排列组合的问题。四种水果，每种只能吃一次，那么总的吃法就是4的阶乘，也就是4*3*2*1=24种。

//正式提问
问:如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午保护区增加了4只大熊猫和 6 只金丝猴，那么保护区一共有多少只动物？
```

输出：

```
答：早上，保护区有15只大熊猫和10只金丝猴，所以一共有25只动物。中午，保护区增加了4只大熊猫和6只金丝猴，所以一共有35只动物（15+4=19只大熊猫，10+6=16只金丝猴，19+16=35只动物）
```

### 8.2.4 零样本思维链提示

第一阶段：推理抽取。

```
// 原始问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？

// 推理生成触发器
让我们一步一步思考。
```

输出如下：

```
早上：15只大熊猫和10只金丝猴
中午：15 + 4 = 19只大熊猫，10 + 6 = 16只金丝猴
因此，自然保护区共有19只大熊猫和16只金丝猴，共有35只动物。
```

第二阶段：答案抽取。

```
问: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？

答: 早上：15只大熊猫和10只金丝猴，中午： 15 + 4 = 19只大熊猫，10 + 6 = 16只金丝猴，因此，自然保护区一共有19只大熊猫和16只金丝猴，一共有35只动物。

因此答案是（数字）：
```

输出：

```
35
```



2. 一阶段零样本思维链

输入：

```
// 原始问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么自然保护区一共有多少只动物？

// 推理生成触发器+答案生成触发器
让我们一步一步思考，并给出最后答案。
```

输出：

```
根据题目描述，早上自然保护区有15只大熊猫和10只金丝猴。中午自然保护区增加了4只大熊猫和6只金丝猴。
首先，我们计算大熊猫的数量。早上有15只大熊猫，中午增加了4只大熊猫，所以大熊猫的总数为15 + 4 = 19只。
接下来，我们计算金丝猴的数量。早上有10只金丝猴，中午增加了6只金丝猴，所以金丝猴的总数为10 + 6 = 16只。
最后，我们将大熊猫和金丝猴的数量相加得到自然保护区动物的总数：19 + 16 = 35只。
所以，自然保护区一共有35只动物。
```



输入：

```
// 原始问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？

// 推理生成触发器 + 答案生成触发器
@分析（详细给出分析过程）
@结论（最终答案）
```

输出：

```
分析：
已知自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴。

结论：
根据加法原理，可得这个自然保护区一共有15 + 10 + 4 + 6 = 35只动物。
```

---

## 8.3 进阶思维链

### 8.3.1 思维表提示

第一阶段：表格生成。

输入：

```
// 原始问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？ 

请按照如下Markdown格式拆解子问题，并针对子问题解决：
| 步骤 | 子问题  | 分析计算过程 | 结果 |`
```

输出：

```
| 步骤 | 子问题 | 分析计算过程 | 结果 |
| --- | --- | --- | --- |
| 1 | 早上的动物数量 | 自然保护区已有的大熊猫数量 + 自然保护区已有的金丝猴数量 | 15 + 10 = 25 |
| 2 | 中午增加的动物数量 | 新增的大熊猫数量 + 新增的金丝猴数量 | 4 + 6 = 10 |
| 3 | 动物总数量 | 早上的动物数量 + 中午增加的动物数量 | 25 + 10 = 35 |
```

第二阶段：答案抽取。

输入：

```
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？

| 步骤 | 子问题 | 分析计算过程 | 结果 |
| --- | --- | --- | --- |
| 1 | 早上的动物数量 | 自然保护区已有的大熊猫数量 + 自然保护区已有的金丝猴数量 | 15 + 10 = 25 |
| 2 | 中午增加的动物数量 | 新增的大熊猫数量 + 新增的金丝猴数量 | 4 + 6 = 10 |
| 3 | 动物总数量 | 早上的动物数量 + 中午增加的动物数量 | 25 + 10 = 35 |

综上，我们得出答案是（数字）？
```

 输出：

```
35
```

### 8.3.2 自我一致提示

```python
from openai import OpenAI
client = OpenAI()

response = client.chat.completions.create(
    model = "gpt-3.5-turbo",
    messages = [
        {"role": "user",  "content":"如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，那么这个自然保护区一共有多少只动物？让我们一步一步思考，并给出最后解答。" }
    ]
    temperature = 0.5,
    max_tokens = 1024,
    top_p = 1,
    n = 5
)
for i, item in enumerate(response["choices"]):
    print("采样", i+1, "-" * 15)
    print(item["text"].strip())
```

输出：

```
采样1 ---
步骤1：首先，我们知道自然保护区有15只大熊猫和10只金丝猴。
步骤2：接着，中午自然保护区增加了4只大熊猫和6只金丝猴。
步骤3：最后，我们可以把15只大熊猫和10只金丝猴加上4只大熊猫和6只金丝猴，得到总共有19只大熊猫和16只金丝猴，所以自然保护区一共有35只动物。

采样2 ---
步骤1：我们首先确定有15只大熊猫和10只金丝猴，一共25只动物。
步骤2：增加4只大熊猫和6只金丝猴，一共有25 + 4 + 6 = 35只动物。
答案：自然保护区一共有35只动物。

采样3 ---
第一步：原本自然保护区有多少只动物？
答：原本自然保护区有15只大熊猫和10只金丝猴，一共有25只动物。

第二步：中午自然保护区增加了多少只动物？
答：中午自然保护区增加了4只大熊猫和6只金丝猴，一共增加了10只动物。

第三步：最终自然保护区一共有多少只动物？
答：最终自然保护区一共有25 + 10 = 35只动物。

采样4 ---
答：自然保护区一共有29只动物，其中有19只大熊猫和16只金丝猴。
 
采样5 ---
答：自然保护区一共有29只动物，包括15只大熊猫和14只金丝猴。
```

### 8.3.3 由少至多提示

第一阶段：分解问题。

（1）零样本提示拆解：

输入：

```
# 任务描述
你的任务是将以下用户的提问拆解成子问题，以便通过解决所有子问题来得出最终答案。

# 用户提问
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴,自然保护区一共有多少只动物？

# 答案格式
1. 子问题1
2. 子问题2
```

输出：

```
1. 早上自然保护区有多少只动物？
2. 中午自然保护区增加了多少只大熊猫？
3. 中午自然保护区增加了多少只金丝猴？
4. 中午自然保护区一共有多少只动物？
```

---

（2）少样本示例拆解

```
# 任务描述
您的主要职责是深入剖析“用户提问”，识别出成功解答该提问所需预先解决的各个子问题，并根据所提供的示例，进行系统的拆解与分析。

# 例子1
用户提问：
如果一个人有两个儿子，每个儿子都有一个姐姐，那么这个人一共有几个孩子？
拆解结果：
1.首先要判断问题中涉及的人物的身份和相互之间的关系。
2.然后计算关系中儿子的数量。
3.最后计算关系中女儿的数量。

# 例子2
用户提问：
小明有6个苹果，小雷有4个李子，中午他们把各自的一半水果送给了小熙，那么小熙吃了2个李子，请问小熙还有多少水果。
拆解结果：
小明有6个苹果，小雷有4个李子，他们一共有多少水果？
小明和小雷各自给了小熙多少水果？
小熙一共得到了多少水果？
小熙吃了2个李子后还剩下多少水果？

# 用户提问
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午增加了4只大熊猫和6只金丝猴，这个自然保护区一共有多少只动物？

# 拆解结果
->
```

输出：

```
1.首先要计算自然保护区原有的大熊猫数量和金丝猴数量。
2.然后计算中午自然保护区增加的大熊猫数量和金丝猴数量。
3.最后计算自然保护区一共有多少只动物，包括大熊猫和金丝猴。
```

---

（3）零样本思维链拆解

```
// 原始问题
问：如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴

// 问题拆解触发器，
为了解决“自然保护区一共有多少只动物？”这个问题，首先需要解决
```

输出：

```
// 拆解出来的子问题
一、最初有多少只动物？
二、增加了多少只动物？
```

问题变换优化的提示

输入：

```
# 任务描述
请你提取一下用户提问的描述句和提问句。

# 用户提问
请计算一下自然保护区总共有多少动物。如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴

# 输出格式
描述句: 请引用原文
提问句: 请引用原文
```

输出：

```
描述句: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴。
提问句: 请计算一下自然保护区总共有多少动物。
```

---

第二阶段：解决子问题。

输入：

```
// 原始问题，拼接上一个拆解的子问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴
问：最初有多少只动物？
```

输出：

```
答：最初有15只大熊猫和10只金丝猴，共25只动物
```

输入：

```
// 原始问题，拼接上一个拆解的子问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴
问：增加了多少只动物？
```

输出：

```
增加了4只大熊猫和6只金丝猴，共10只动物。
```

---

第三阶段：汇总最终答案。

```
/ 原始问题
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴

// 子问题+答案拼接
问: 最初有多少只动物？
答: 最初有15只大熊猫和10只金丝猴，共25只动物。
问: 增加了多少只动物？
答: 增加了4只大熊猫和6只金丝猴，共10只动物。

// 汇总答案
综上，自然保护区一共有多少只动物？
```

输出：

```
答: 自然保护区一共有35只动物。
```

### 8.3.4 自问自答提示

```
// 原始问题
问题：原始问题。

// 拆解并解决子问题
是否需要拆解子问题：是否需要拆解子问题。
后续问题：拆解子问题。
中间答案：子问题答案。

// 汇总答案
因此最终答案是：最终答案。
```

```
// 少样本示例启发大语言模型拆解问题
问题：如果一个正方形的面积是64平方厘米，那么它的周长是多少？
是否需要拆解子问题：是
后续问题：一个正方形的边长等于它的面积开平方根，那么64平方厘米的正方形的边长是多少？
中间答案：8厘米
是否需要拆解子问题：是
后续问题：一个正方形的周长等于它的边长乘以4，那么8厘米的正方形的周长是多少？
中间答案：32厘米
是否需要拆解子问题：否
因此最终答案是：32厘米

// 正式提问
问题：刘翔获得奥运金牌那一年国际奥委会主席是谁？
是否需要拆解子问题：
```

```
// 第1轮
是
子问题：刘翔获得奥运金牌的那一年是哪一年？
答案：在2004年雅典奥运会上，刘翔成了中国第一位奥运会田径金牌得主。在2004年雅典奥运会男子110米栏比赛中，刘翔一路领先，最终以12秒91的成绩夺得冠军（调用搜索）。

// 第2轮
是否需要拆解子问题：是
子问题：2004年国际奥委会主席是谁？
答案：2004年雅典奥运会_全球百科，雅典奥组委主席安杰洛普洛斯夫人和国际奥委会主席罗格分别致辞。希腊总统斯特凡诺普洛斯宣布本届奥运会正式开幕。(调用搜索)

// 第3轮
是否需要拆解子问题：否
// 模型在这里给出了无须进一步拆解子问题的判断
```

```
// 汇总给出最终的答案-请求大语言模型
{代入第1轮，第2轮，第3轮的子问题和答案}
因此最终答案是：罗格
```

## 8.4 高阶思维链

### 8.4.1 思维树提示

第一阶段：问题分解。

输入：

```
# 任务描述
你的任务是对用户提问进行子问题拆解，以达到通过求解所有子问题能给出最终答案的目的。

# 用户提问
如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，自然保护区一共有多少只动物？

# 答案格式
1.子问题1
2.子问题2
……（根据需要确认是否继续拆解子问题）
```

输出：

```
子问题1: 早上的时候自然保护区有多少只动物？
子问题2: 中午自然保护区新增加了多少只动物？
子问题: 晚上有多少只动物被送出了动物园？
```

第二阶段：扩展子节点。

1.想法生成。

（1）深度生成：

```
// 问题
问题：如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，自然保护区一共有多少只动物？

// 当前状态或者思维链
子问题：早上的时候自然保护区有多少只动物？

// 下一个思考
针对"子问题"请一步一步给出这个问题的答案
```

输出：

```
解决思路：早上自然保护区有15只大熊猫和10只金丝猴，因此早上自然保护区一共有25只动物。答案：25只动物。
```

（2）广度生成

输入：

```
// 问题
问题：如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，自然保护区一共有多少只动物？

// 状态
子问题: 早上的时候自然保护区有多少只动物？

// k个可能的思考
针对[子问题]请提出几种不同的解决思路，并给出答案。

# 答案格式
1.思路1
2.思路2
……（根据需要确认是否需要给出更多的思路）
```

输出：

```
1. 思路1: 早上自然保护区有15只大熊猫和10只金丝猴，因此早上自然保护区一共有25只动物。
2. 思路2: 早上自然保护区有15只大熊猫，加上中午增加的4只大熊猫和6只金丝猴，因此早上自然保护区一共有25只动物。
```

---

2.状态评估

（1）深度状态评估

输入：

```
问题: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园。
子问题：中午自然保护区新增加了多少只动物？
子问题答案：中午之后自然保护区增加了19只大熊猫和16只金丝猴。

请评估上述子问题和子问题答案是否正确（请先回答正确/不正确）
```

输出：

```
子问题答案: 不正确
中午之后自然保护区增加了4只大熊猫和6只金丝猴，而不是19只大熊猫和16只金丝猴。
```

（2）广度状态评估

输入：

```
// 问题
问题: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，自然保护区一共有多少只动物？

// k个状态
子问题: 中午自然保护区新增加了多少只动物？
有以下解决思路：    
    1.思路1：计算减少的动物数量，15只大熊猫减去8只，10只金丝猴减去0只，一共减少8只动物。
    2.思路2：计算增加的动物数量，15只大熊猫加4只，10只金丝猴加上6只，一共增加10只动物。

// 最优或最差状态
上述方案中你认为能正确地解决问题思路是？
```

输出：

```
思路2：计算增加的动物数量，15只大熊猫加4只，10只金丝猴加上6只，一共增加10只动物。
```

---

第三阶段：生成答案。

输入：

```
// 问题
问题: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴,晚上有8只动物被送出了动物园

// 子问题和答案
解决该问题的过程如下:

子问题1: 早上的时候自然保护区有多少只动物？
答案: 早上自然保护区有15只大熊猫，加上中午增加的4只大熊猫和6只金丝猴，因此早上自然保护区一共有25只动物。

子问题2: 中午之后自然保护区一共增加了多少只动物？
答案: 计算增加的动物数量，15只大熊猫加4只，10只金丝猴加上6只，一共增加10只动物。

子问题3: 晚上有多少只动物被送出了动物园？
答案: 根据题目中的信息，早上有15只大熊猫和10只金丝猴，中午增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，因此晚上被送出的动物数量为8只。

// 得出最终答案
因此，自然保护区一共有多少只动物？
```

输出：

```
答案: 根据以上计算，早上自然保护区一共有25只动物，中午增加了10只动物，晚上有8只动物被送出了动物园，因此晚上自然保护区一共有27只动物。
```

### 8.4.2 推理-行动提示

```
# 任务描述
请按照"回答格式"，根据用户输入从工具列表中选择合适的工具解决问题，工具的参数格式如下：

@工具名称(参数1, 参数2, ...): 工具功能描述

# 工具描述
@定位(): 获取用户当前的定位城市
@天气(城市名称): 查看天气预报
@导航(起点，终点): 规划地点A到地点B的驾驶路线
@计算器(数字1，运算符，数字2): 进行简单的四则运算
@时钟(): 获取当前的日期和时间
@搜索(搜索关键词): 当以上工具都无法使用时，尝试使用这个搜索引擎工具
@补充(需要补充的问题): 当你回答问题的依赖信息不足时，调用这个工具可以让人工给你补充一些信息
@自答(需要回答的问题): 当以上工具无法使用时，可以依靠你自己的知识直接给出答案，请注意输出事实不要杜撰

# 回答格式
思考: 请保持思考，结合上下文背景，请首先判断解决该问题的素材是否满足，然后给出要解决这个问题的方案和分析过程，
动作: @工具名称(参数1, 参数2, ...)。每次动作只选择一个工具。工具列表"工具描述"
观察: <工具返回的结果>

...（这个“思考-动作-输入-观察”的循环可以重复N次）

思考: 最后，已经得到最终结果了
最终结果: 针对原始问题，输出最终结果

# 用户问题
问题: {question}

# 回答过程
<第1轮>
```

---

例子1：北京到襄阳怎么走？襄阳本地有哪些好玩的地方？

```
# 回答过程
<第1轮>
思考: 根据用户的问题，首先需要通过定位工具确定用户当前所在的城市，然后使用导航工具规划从北京到襄阳的驾驶路线。接下来，可以使用搜索工具来获取襄阳本地的旅游景点信息。
动作: @定位()
观察: 根据定位结果，得知用户当前所在城市为北京。

<第2轮>
思考: 现在已经知道用户当前所在城市是北京，下一步可以使用导航工具来规划从北京到襄阳的驾驶路线。
动作: @导航(北京，襄阳)
观察: 导航工具返回了从北京到襄阳的驾驶路线。

<第3轮>
思考: 现在已经得到了从北京到襄阳的驾驶路线，接下来可以使用搜索工具来获取襄阳本地的旅游景点信息。
动作: @搜索(襄阳旅游景点)
观察: 襄阳市的旅游景点有：1. 襄阳古城墙... 2. 古隆中景区... 3. 钟鼓楼...

<第4轮>
思考: 已经得到了襄阳本地的旅游景点信息，可以将这些信息整理后输出给用户。
最终结果: 从北京到襄阳的驾驶路线如下：起点为北京，终点为襄阳，走京开高速→G45大广高速→S83兰南高速，距离1059.36千米，耗时10小时37分钟。
襄阳本地的好玩的地方有：1. 襄阳古城墙... 2. 古隆中景区... 3. 钟鼓楼...
```

---

例子2：王军老师的身高乘以2是多少，并以王老师身高为题做一首诗。

```
<第1轮>
思考: 需要获取王老师的身高，可以使用@补充工具
动作: @补充(王老师身高)
观察: 王老师身高为180cm

<第2轮>
思考: 需要计算180cm乘以2的结果，可以使用@计算器工具
动作: @计算器(180cm,*,2)
观察: 180cm乘以2的结果为360cm

<第3轮>
思考: 需要根据360cm写一首诗，可以使用@自答工具
动作: @自答(根据360cm写一首诗)
观察: 王老师高达三百六十，他的身材犹如一棵树，他的脚步踏遍大江南北，他的知识智慧比满天星。

<第4轮>
思考: 最后，已经得到最终结果了
最终结果: 王老师的身高是王老师身高为180cm，给王老师写的诗是：王老师高达三百六十，他的身材犹如一棵树，他的脚步踏遍大江南北，他的知识智慧比满天星。
```

### 8.4.3 自动思维链提示

第一阶段：构建候选示例样本。

```
一个人每天吃两个苹果，不管是红色的还是绿色的，一个月能吃多少个苹果？
一个人在一年中的每个月都买了一本书，但是在2月和8月他买了两本书，其中有3本是小说，其余的都是散文，那么这个人一年中一共买了多少本书？
一个人有5种颜色的衣服，分别是红色、蓝色、绿色、黄色和黑色，他每天只穿一种颜色的衣服，他最喜欢的颜色是蓝色，那么他在一个星期内能有多少种不同的穿衣搭配？
一个人有4种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，他最不喜欢吃的水果是西瓜，那么他吃完所有水果的顺序有多少种？
一个人有两个骰子，每个骰子有6个面，分别是1、2、3、4、5和6，他每次只能掷一个骰子，然后记录下来，那么他掷出两个相同数字的概率是多少？
一个人有10个朋友，分别叫作A、B、C、D、E、F、G、H、I和J，他每天只能给其中一个朋友发一条微信消息，然后换一个朋友，那么他在一个星期内能给多少个朋友发消息？
```

---

第二阶段：候选示例样本聚类。

方法1：使用“语义向量化+聚类算法”

```
from sentence_transformers import SentenceTransformer
from sklearn.cluster import KMeans

st = SentenceTransformer('bert-base-nli-mean-tokens')

question_list = [
  "上述问题文本列表"，
  "...."，
] 

#使用SentenceTransformer进行文本向量化
X = []
for question in question_list:
      question_vec = st.encode(question)
       X.append(question_vec)

#使用sklearn库的Means算法进行聚类
km = KMeans(n_clusters = 3).fit(X)
cluster_centers = km.cluster_centers_
```

方法2：使用大语言模型直接进行语义聚类。

输入：

```
把以下问题聚类为3个簇，说明理由：

<第一阶段的数据集问题列表>
```

输出：

```
将以上问题聚类为3个簇的理由如下：

簇1：计算问题
- 一个人每天吃两个苹果，不管是红色的还是绿色的，一个月能吃多少个苹果？
- 一个人在一年中的每个月都买了一本书，但是在2月和8月他买了两本书，其中有3本是小说，其余的都是散文，那么这个人一年中一共买了多少本书？

簇2：组合问题
- 一个人有5种颜色的衣服，分别是红色、蓝色、绿色、黄色和黑色，他每天只穿一种颜色的衣服，他最喜欢的颜色是蓝色，那么他在一个星期内能有多少种不同的穿衣搭配？
- 一个人有4种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，西瓜是其中最大的水果，那么他吃完所有水果的顺序有多少种？

簇3：排列问题
- 一个人有两个骰子，每个骰子有6个面，分别是1、2、3、4、5和6，他每次只能掷一个骰子，然后记录下来，那么他掷出两个相同数字的概率是多少？
- 一个人有10个朋友，分别叫作A、B、C、D、E、F、G、H、I和J，他每天只能给其中一个朋友发一条微信消息，然后换一个朋友，那么他在一个星期内能给多少个朋友发消息？

以上问题通过对问题类型的分类，可以将其聚类为上述3个簇，便于进一步分析和解决。
```

---

利用大语言模型从每个聚类簇中选择一个代表性问题

输入：

```
从下面的聚类的每个簇里面各选择一个具有代表性的问题，说明理由：
<问题语义聚类中的结果>
```

输出：

```
簇1代表性问题：一个人每天吃两个苹果，不管是红色的还是绿色的，一个月能吃多少个苹果？

簇2代表性问题：一个人有4种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，西瓜是其中最大的水果，那么他吃完所有水果的顺序有多少种？

簇3代表性问题：一个人有10个朋友，分别叫作A、B、C、D、E、F、G、H、I和J，他每天只能给其中一个朋友发一条微信消息，然后换一个朋友，那么他在一个星期内能给多少个朋友发消息？
```

第三阶段：示例采样。

```
问: 一个人每天吃两个苹果，不管是红色的还是绿色的，一个月能吃多少个苹果？
答: 首先，我们知道一个人每天吃两个苹果。然后，我们需要知道一个月有多少天。通常情况下，一个月可能有28天、30天或31天。所以，如果一个月有30天的话，那么这个人就会吃到60个苹果（2苹果/天 × 30天/月 = 60苹果/月）。如果一个月有31天的话，那么这个人就会吃到62个苹果（2苹果/天 × 31天/月 = 62苹果/月）。而如果是二月份（非闰年），那么这个人就会吃到56个苹果（2苹果/天 × 28天/月 = 56苹果/月）

问: 一个人有4种水果，分别是苹果、香蕉、橘子和西瓜，他每次只能吃一种水果，然后换一种水果，西瓜是其中最大的水果，那么他吃完所有水果的顺序有多少种？
答: 首先，我们知道这个人有4种水果：苹果、香蕉、橘子和西瓜。他每次只能吃一种水果，然后换一种水果。那么，他吃完所有水果的顺序有多少种呢？这其实是一个排列组合的问题。4种水果，每种只能吃一次，那么总的吃法就是4的阶乘，也就是432 * 1 = 24种。

问: 一个人有10个朋友，分别叫作A、B、C、D、E、F、G、H、I和J，他每天只能给其中一个朋友发一条微信消息，然后换一个朋友，那么他在一个星期内能给多少个朋友发消息？
答: 这个问题的答案取决于一周的定义。如果我们按照一周7天来计算，那么他每天给一个朋友发消息，一周内就可以给7个朋友发消息。但是，如果我们按照一周5天（工作日）来计算，那么他一周内可以给5个朋友发消息。所以，他在一个星期内能给5-7个朋友发消息，具体取决于你如何定义“一个星期”。
```

---

第四阶段：生成答案。

输入：

```
// 采样的示例
<第三阶段采样结果>

// 实际要问的问题
问: 如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴,晚上有8只动物被送出了动物园，2只大熊猫提前开始呼呼睡觉,自然保护区一共有多少只动物？
  
答: 首先，我们知道自然保护区开始时有15只大熊猫和10只金丝猴，总共25只动物。然后，中午自然保护区增加了4只大熊猫和6只金丝猴，增加了10只动物。所以，到中午时，自然保护区里总共有35只动物。晚上有8只动物被送出了动物园，所以剩下27只动物。然后，2只大熊猫提前开始呼呼睡觉，但是它们仍然在自然保护区内，所以最后自然保护区一共有27只动物。
```

输出：

```
首先，我们知道自然保护区开始时有15只大熊猫和10只金丝猴，总共25只动物。然后，中午自然保护区增加了4只大熊猫和6只金丝猴，增加了10只动物。所以，到中午时，自然保护区里总共有35只动物。晚上有8只动物被送出了动物园，所以剩下27只动物。然后，2只大熊猫提前开始呼呼睡觉，但是它们仍然在自然保护区内，所以最后自然保护区一共有27只动物。
```

## 8.5 尝试构建自己的思维链

### 8.5.1 自由辩论提示

输入：

```
下面是一场关于解决问题的辩论，由红蓝双方交替发言，发言内容可以包括：
1）指出并批评对方错误
2）分析双方回答中的共识，重新论证并给出最终答案

问题：如果一个自然保护区有15只大熊猫和10只金丝猴，早上这15只大熊猫获得了喂食，中午自然保护区增加了4只大熊猫和6只金丝猴，晚上有8只动物被送出了动物园，2只大熊猫提前开始呼呼睡觉，自然保护区一共有多少只动物？

红方先发言：
```

红方：

```
红方发言：

// 实际上蓝方在此之前并没有发言而是自己的臆想
首先，我要指出蓝方的错误。蓝方认为自然保护区一共有25只动物，这是一个错误的答案。因为蓝方没有考虑到晚上有8只动物被送出了动物园，这意味着自然保护区的动物数量减少了8只。所以，正确的答案应该是25 - 8 = 17只动物。

其次，我要分析双方回答中的共识。双方都同意早上自然保护区有15只大熊猫和10只金丝猴，中午自然保护区增加了4只大熊猫和6只金丝猴。这些信息可以用数学公式表示为：

早上：大熊猫 = 15，金丝猴 = 10
中午：大熊猫 = 15+4=19，金丝猴 = 10 + 6 = 16

最后，我要重新论证并给出最终答案。除了晚上有8只动物被送出了动物园，还有一个细节是2只大熊猫提前开始呼呼睡觉。这意味着这2只大熊猫不属于自然保护区的动物数量，因为它们已经不在自然保护区内了。所以，最终的答案应该是：

晚上：大熊猫 = 19 - 8 - 2 = 9，金丝猴 = 16 - 0 = 16
总数：9 + 16 = 25

因此，我认为自然保护区一共有25只动物是正确的答案。
```

蓝方：

```
蓝方发言：

我不同意红方的答案，我认为红方的错误有两个方面：

一是红方没有说明晚上被送出了动物园的8只动物是什么种类，这是一个重要的信息，因为不同种类的动物对自然保护区的动物数量有不同的影响。如果被送出的8只动物都是大熊猫，那么自然保护区的大熊猫数量就会减少8只，但如果被送出的8只动物都是金丝猴，那么自然保护区的金丝猴数量就会减少8只。所以，红方的答案是不完整的，需要更多的信息才能确定。

二是红方错误地认为2只大熊猫提前开始呼呼睡觉就不属于自然保护区的动物数量，这是一个错误的假设，因为这2只大熊猫并没有离开自然保护区，它们只是在自然保护区内睡觉而已。所以，这2只大熊猫仍然属于自然保护区的动物数量，不能被排除在外。

接下来，我要分析双方回答中的共识。双方都同意早上自然保护区有15只大熊猫和10只金丝猴，中午自然保护区增加了4只大熊猫和6只金丝猴。这些信息可以用数学公式表示为：

早上：大熊猫 = 15，金丝猴=10
中午：大熊猫 = 15 + 4 = 19，金丝猴 = 10 + 6 = 16

最后，我要重新论证并给出最终答案。根据我的分析，晚上被送出了动物园的8只动物是什么种类是关键信息，如果没有这个信息，就无法确定自然保护区的动物数量。所以，我认为这个问题没有一个确定的答案，需要更多的信息才能解决。
```

---

第二阶段：裁判总结

输出：

```
// 第一阶段发言过程
红方: ……
蓝方: ……
红方: ……
蓝方: ……

// 裁判总结
裁判总结：基于上述对双方发言进行总结，并判定给出最终的答案
```

输入：

```
裁判总结:

这是一场关于解决问题的辩论，红方和蓝方交替发言，指出并批判对方错误，分析双方回答中的共识，重新论证并给出最终答案。

红方认为自然保护区一共有25只动物，蓝方认为自然保护区一共有27只动物。双方的分歧主要在于如何理解自然保护区一共有多少只动物的定义，以及如何处理晚上被送出了动物园的8只动物是什么种类和2只大熊猫提前开始呼呼睡觉的情况。

经过主席的仔细评判，最终的答案是：**自然保护区一共有27只动物**。原因如下：……（略）

因此，根据问题中给出的所有信息，最终的答案应该是：

晚上：大熊猫 = 19 - 8 = 11，金丝猴 = 16 - 0 = 16
总数：11 + 16 = 27

感谢红方和蓝方的精彩发言，也感谢观众们的关注和支持。这场辩论到此结束。谢谢大家！
```

### 8.5.2 圆桌会议提示

第一阶段：主持人陈述问题。

```
# 任务描述
下面是一场关于解决问题的圆桌会议，参会人员有主持人、生物老师、数学老师和物理老师。参会者需要结合自己的身份独立思考给出答案，禁止杜撰，每人每次发言不超过 100 字。

# 会议主题
如果一个自然保护区有 15 只大熊猫和 10 只金丝猴，早上这 15 只大熊猫获得了喂食，中午增加了 4 只大熊猫和 6只金丝猴，晚上有 8 只动物被送出，2 只大熊猫提前开始呼呼睡觉，自然保护区一共有多少只动物？

# 会议记录
主持人发言：我们的需要是找出正确的答案，并解释我们的思路和方法，请大家踊跃发言。
```

第二阶段：参会人员轮流发言。

输入：

```
下面有请生物老师发言。
```

输出：

```
生物老师发言：从生物生态学的视角，自然保护区内的生物多样性是我们的宝贵财富。大熊猫和金丝猴，无论活动还是休息，都是生态系统中的重要成员。初始时，我们有25个生态单位，随后引入了新的10个单位，并移除了8个。值得注意的是，生态单位数量并非随动物行为改变而立即变动，所以，即便部分大熊猫选择了休息，我们自然保护区的生态单位总数仍为27个。
```

输入：

```
下面有请数学老师发言。
```

输出：

```
数学老师发言：基于数学逻辑，这是一道涉及加法与减法的纯粹计算题。首先，我们将初始数量25视为一个集合，然后加入新的集合元素10，再从中减去8个元素。这里的关键是理解，元素（即动物）的状态（如休息）不影响其在集合中的存在性。因此，最终集合中的元素数量为27，这是纯粹的数学事实，与任何生物学或物理学因素无关。
```

输入

```
下面有请物理老师发言。
```

输出

```
物理老师发言：从物理学的角度看，自然保护区是一个封闭或半封闭的空间系统。在这个系统中，动物的物理存在（无论是动态活动还是静态休息）都占据了空间，并对系统的总质量有所贡献。因此，在计算保护区内的动物总数时，我们必须将所有在该空间内占据物理位置的动物纳入考虑，不论其当前的行为状态如何。所以，无论大熊猫是否在休息，保护区内的动物总数依然是27只。
```



第三阶段：主持人总结答案。

输入：

```
主持人总结发言：……最终我们形成的答案是：

经过我们的讨论，我们得出了一个一致的答案，那就是**27只动物**。我们用了不同的学科知识和方法来解决这个问题，展示了我们的多元思维和创造力。我感谢所有的参与者，你们都做得很好。我希望这次会议能够启发我们对动物保护的关注和行动。谢谢大家。
```

